Modules
=======

Thermodynamic observables
-------------------------

### Objective

This module defines a set of thermodynamic observables commonly output by
molecular simulation programs.


### Module name and version

The name of this module is `thermodynamics`. The module version is 1.0.0.


### Observables

Thermodynamic observables are stored in the `observables` group for global
properties or in `observables/<group>` for subsystems, similarly to the
`particles` group. The groups have the following contents:

    observables
     \-- <group>
          +-- dimension: Integer[]
          \-- particle_number
          \-- (pressure)
          \-- (temperature)
          \-- (density)
          \-- ...

`dimension`
  : A scalar attribute of `Integer` type that gives the dimension of the space
    embedding the subsystem.

`particle_number`
  : The number of particles in the subsystem stored as `Integer` datatype.

The following H5MD elements are optional, of scalar character, and use the
`Float` datatype.

`pressure`
  : The pressure of the subsystem.

`temperature`
  : The (instantaneous) temperature of the subsystem as inferred from the
    kinetic energy.

`density`
  : The number density of the subsystem stored as `Float` or `Integer`
    datatype.

`potential_energy`
  : The potential energy of the subsystem.

`kinetic_energy`
  : The kinetic energy of the subsystem.

`internal_energy`
  : The internal energy of the subsystem, typically the sum of potential and
    kinetic energy.

`enthalpy`
  : The enthalpy of the subsystem.

The latter 4 quantities are stored as per-particle averages. The corresponding
extensive quantities (scaling linearly with the system size) are obtained by
multiplication with the number of particles. Per-volume averages follow by
multiplication with the number density if present.


Units
-----

### Objective

This module defines how physical units are attached to dimensionful H5MD
elements.


### Module name and version

The name of this module is `units`. The module version is 1.0.0.

### Module specification

The module specification in `h5md/modules` the the attributes `version` and
`encoding`.

    h5md
     \-- modules
          \-- units
          |    +-- version: Integer[2]
          |    +-- encoding: VL String[]
          \-- ...

`version`
:   An attribute, of `Integer` datatype and of simple dataspace of shape `[2]`,
    that contains the major and minor version numbers of the module, i.e., `{1, 0}`.

`encoding`
:   A scalar attribute of variable-length `String` datatype that specifies the
    character set used in the `units` attributes (see below). It is one of
    `ASCII` or `UTF8`.


### Unit attribute

The datasets of any H5MD element that have a physical dimension may carry an
attribute `unit` to indicate the physical unit of the respective data. In
general, this refers to the dataset itself for time-independent elements, or to
the datasets `value` and `time` in the time-dependent case:

    <element>
     \-- step: Integer[variable]
     \-- time: Float[variable]
     |    +-- (unit: VL String[])
     \-- value: <type>[variable][...]
          +-- (unit: VL String[])

The attribute `unit` is of scalar dataspace and variable-length `String`
datatype using ASCII or UTF8 character sets as indicated by the `encoding`
attribute in the module specification.

The `unit` string consists of a sequence of unit factors separated by a space.
A unit factor is either a number (an integer or a decimal fraction) or a unit
symbol optionally followed by a non-zero integer indicating the power to which
this factor is raised. In UTF8 encoding, the power may be denoted by
superscripted characters: ⁻¹²³⁴⁵⁶⁷⁸⁹⁰.  Each unit symbol may occur only once.
There may also be at most one numeric factor, which must be the first one.

Examples:

  - "nm3" or "nm³" stands for cubic nanometers

  - "um2 s-1" or "µm² s⁻¹" stands for micrometers squared per second

  - "60 s" stands for a minute

  - "10+3 m" or "10³ m" stands for a kilometer


### Unit symbols

Allowed unit symbols include a subset of the SI units plus some common non-SI
units:

+-------------------------+---------------+--------------------------+------------------------------------------+
| dimension               | symbol string | unit name                | conversion                               |
+=========================+===============+==========================+==========================================+
| length                  | m             | meter                    | SI base unit                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | Å, Ang        | Ångström                 | 1 Å = 0.1 nm                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
| volume                  | L             | liter                    | 1 L = 1 dm³                              |
+-------------------------+---------------+--------------------------+------------------------------------------+
| time                    | s             | second                   | SI base unit                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | min           | minute                   | 1 min = 60 s                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | h             | hour                     | 1 h = 60 min                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
| frequency               | Hz            | hertz                    | 1 Hz = 1 s⁻¹                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
| mass                    | kg            | kilogram                 | SI base unit                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | g             | gram                     | 1 g = 10⁻³ kg                            |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | u             | unified atomic mass unit | 1 u = 1.6605402 × 10⁻²⁷ kg               |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | Da            | dalton                   | 1 Da = 1 u                               |
+-------------------------+---------------+--------------------------+------------------------------------------+
| force                   | N             | newton                   | 1 N = 1 kg m s⁻²                         |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | dyn           | dyne                     | 1 dyn = 1 g cm s⁻²                       |
+-------------------------+---------------+--------------------------+------------------------------------------+
| pressure,               | Pa            | pascal                   | 1 Pa = 1 N m⁻²                           |
+-------------------------+---------------+--------------------------+------------------------------------------+
| stress                  | bar           | bar                      | 1 bar = 100 kPa                          |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | atm           | atmosphere               | 1 atm = 101.325 kPa                      |
+-------------------------+---------------+--------------------------+------------------------------------------+
| viscosity               | P             | poise                    | 1 poise = 0.1 Pa s                       |
+-------------------------+---------------+--------------------------+------------------------------------------+
| energy,                 | J             | joule                    | 1 J = 1 N m                              |
+-------------------------+---------------+--------------------------+------------------------------------------+
| work,                   | cal           | calory                   | 1 cal =  4.1868 J                        |
+-------------------------+---------------+--------------------------+------------------------------------------+
| heat                    | erg           | erg                      | 1 erg = 100 nJ                           |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | eV            | electron volt            | 1 eV = 1 e V                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
| power                   | W             | watt                     | 1 W = 1 J s⁻¹                            |
+-------------------------+---------------+--------------------------+------------------------------------------+
| temperature             | K             | kelvin                   | SI base unit                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | °C            | degree celcius           | x / K = (x / °C + 273.15)                |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | °F            | degree fahrenheit        | x / °C = 5 / 9 × (x / °F – 32)           |
+-------------------------+---------------+--------------------------+------------------------------------------+
| amount of substance     | mol           | mole                     | SI base unit                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
| electric current        | A             | ampere                   | SI base unit                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
| electric charge         | C             | coulomb                  | 1 C = 1 A s                              |
+-------------------------+---------------+--------------------------+------------------------------------------+
| voltage                 | V             | volt                     | 1 V = 1 J A⁻¹ s⁻¹                        |
+-------------------------+---------------+--------------------------+------------------------------------------+
| electric capacitance    | F             | farad                    | 1 F = 1 A s V⁻¹                          |
+-------------------------+---------------+--------------------------+------------------------------------------+
| electric resistance     | Ω             | ohm                      | 1 Ω = 1 V A⁻¹                            |
+-------------------------+---------------+--------------------------+------------------------------------------+
| magnetic field strength | T             | tesla                    | 1 T = 1 V s m⁻²                          |
+-------------------------+---------------+--------------------------+------------------------------------------+
| luminous intensity      | Cd            | candela                  | SI base unit                             |
+-------------------------+---------------+--------------------------+------------------------------------------+
| angle                   | rad           | radian                   | dimensionless                            |
+-------------------------+---------------+--------------------------+------------------------------------------+
|                         | °, deg        | arc degree               | 180 deg = π                              |
+-------------------------+---------------+--------------------------+------------------------------------------+

Table: Unit symbols, names and conversion rules.

+-----------------+--------------------------+------------------------------------------+
| constant symbol | name                     | value                                    |
+=================+==========================+==========================================+
| π, pi           | Pi                       | π = 3.141592653589793238462643383279     |
+-----------------+--------------------------+------------------------------------------+
| kB              | Boltzmann's constant     | k~B~ = 1.3806488 × 10⁻²³ J K⁻¹           |
+-----------------+--------------------------+------------------------------------------+
| Nav             | Avogadro number          | N~av~ = 6.02214179 × 10²³ mol⁻¹          |
+-----------------+--------------------------+------------------------------------------+
| c               | speed of light           | c = 299792458 m s⁻¹                      |
+-----------------+--------------------------+------------------------------------------+
| h               | Planck's constant        | h = 6.62606957 × 10⁻³⁴ J s               |
+-----------------+--------------------------+------------------------------------------+
| e               | electron charge          | e = 1.602176487 × 10⁻¹⁹ A s              |
+-----------------+--------------------------+------------------------------------------+
| me              | electron mass            | m~e~ = 9.10938215 × 10⁻³¹ kg             |
+-----------------+--------------------------+------------------------------------------+

Table: Constants.

### Unit prefixes

A unit symbol may include an SI prefix from the following list:

+--------+---------------+--------+
| prefix | symbol string | factor |
+========+===============+========+
| exa-   | E             | 10¹⁸   |
+--------+---------------+--------+
| peta-  | P             | 10¹⁵   |
+--------+---------------+--------+
| tera-  | T             | 10¹²   |
+--------+---------------+--------+
| giga-  | G             | 10⁹    |
+--------+---------------+--------+
| mega-  | M             | 10⁶    |
+--------+---------------+--------+
| kilo-  | k             | 10³    |
+--------+---------------+--------+
| hecto- | h             | 10²    |
+--------+---------------+--------+
| deca-  | da            | 10¹    |
+--------+---------------+--------+
| deci-  | d             | 10⁻¹   |
+--------+---------------+--------+
| centi- | c             | 10⁻²   |
+--------+---------------+--------+
| milli- | m             | 10⁻³   |
+--------+---------------+--------+
| micro- | µ, u          | 10⁻⁶   |
+--------+---------------+--------+
| nano-  | n             | 10⁻⁹   |
+--------+---------------+--------+
| pico-  | p             | 10⁻¹²  |
+--------+---------------+--------+
| femto- | f             | 10⁻¹⁵  |
+--------+---------------+--------+
| atto-  | a             | 10⁻¹⁸  |
+--------+---------------+--------+

Table: SI prefixes.
